"use strict";(self["webpackChunkboard_site_front"]=self["webpackChunkboard_site_front"]||[]).push([[395],{1584:function(e,t,a){a.d(t,{Z:function(){return o}});var i=a(3396),s=a(6171),n=a(4870),l={__name:"ToastModifyEditor",props:{content:{type:String,required:!0}},emits:["contentChange"],setup(e,{emit:t}){const l=e,r=(0,n.iH)(null),o=a(6265);return(0,i.bv)((()=>{const e=new s.ZP({el:r.value,height:"500px",initialValue:l.content,initialEditType:"wysiwyg",previewStyle:"tab",useDefaultHTMLSanitizer:!1,language:"ko-KR",usageStatistics:!1,hideModeSwitch:!0,hooks:{addImageBlobHook:(e,t)=>{const a={"content-type":"multipart/form-data"},i=new FormData;i.append("multiFile",e),o.post("/api/common/file-upload",i,{headers:a}).then((e=>{t(e.data[0].filePath)})).catch((()=>{})).finally((()=>{}))}},events:{change:()=>t("contentChange",e.getHTML())},toolbarItems:[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task"],["table","image","link"],["scrollSync"]]})})),(e,t)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"refEditor",ref:r},null,512))}};const r=l;var o=r},1395:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var i=a(3396),s=a(9242),n=a(7139);const l=e=>((0,i.dD)("data-v-04a10dbe"),e=e(),(0,i.Cn)(),e),r={id:"contact",class:"contact-area section-padding"},o={class:"container"},d={class:"row"},h={class:"col-lg-7"},c={class:"contact"},u={class:"row",style:{"margin-top":"2rem"}},p={class:"form-group col-md-12"},g={class:"form-group col-md-12",style:{"margin-top":"1rem"}},m={class:"col-md-12 text-center",style:{"margin-top":"1rem"}},y={class:"col-lg-5",style:{"margin-top":"2rem"}},v={class:"single_address"},_=l((()=>(0,i._)("i",{class:"fa fa-map-marker"},null,-1))),f=l((()=>(0,i._)("h4",null,"도시 ",-1))),w={style:{"margin-top":"10px"}},C=(0,i.uE)('<option value="" data-v-04a10dbe>선택</option><option value="서울" data-v-04a10dbe>서울</option><option value="부산" data-v-04a10dbe>부산</option><option value="울산" data-v-04a10dbe>울산</option><option value="대구" data-v-04a10dbe>대구</option><option value="대전" data-v-04a10dbe>대전</option><option value="제주" data-v-04a10dbe>제주</option>',7),b=[C],P={class:"single_address"},I=l((()=>(0,i._)("i",{class:"fa fa-user"},null,-1))),k=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"인원",-1))),D={class:"single_address"},$=l((()=>(0,i._)("i",{class:"fa fa-plane"},null,-1))),A=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"출발일",-1))),S=["min"],U={class:"single_address"},x=l((()=>(0,i._)("i",{class:"fa fa-money"},null,-1))),T=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"가격",-1))),E=(0,i.Uk)(" 원가: "),L=(0,i.Uk)(" 할인율: "),F=l((()=>(0,i._)("br",null,null,-1))),M={style:{"margin-top":"12px"}},R={class:"single_address"},V=l((()=>(0,i._)("i",{class:"fa fa-calendar"},null,-1))),q=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"마감일",-1))),z=["min"],B={key:0,class:"single_address"},H=l((()=>(0,i._)("i",{class:"fa fa-list"},null,-1))),Z=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"여행사",-1))),j=l((()=>(0,i._)("option",{selected:"",value:"0"},"선택하세요",-1))),K=["value"],Y={class:"single_address"},O={class:"file-label",for:"chooseFile"},W=l((()=>(0,i._)("i",{class:"fa fa-image"},null,-1))),G=(0,i.Uk)("썸네일 "),J={key:1,style:{width:"400px",height:"250px"}},N=["src"];function Q(e,t,a,l,C,Q){const X=(0,i.up)("ToastEditor");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("div",o,[(0,i._)("div",d,[(0,i._)("div",h,[(0,i._)("div",c,[(0,i._)("div",u,[(0,i._)("div",p,[(0,i.wy)((0,i._)("input",{type:"text",name:"name",class:"form-control",placeholder:"제목을 입력하세요",required:"required","onUpdate:modelValue":t[0]||(t[0]=t=>e.travelTitle=t)},null,512),[[s.nr,e.travelTitle]])]),(0,i._)("div",g,[e.test?((0,i.wg)(),(0,i.j4)(X,{key:0,onContentChange:Q.editorContent,content:e.content},null,8,["onContentChange","content"])):(0,i.kq)("",!0)]),(0,i._)("div",m,[(0,i._)("button",{class:"btn btn-contact-bg",onClick:t[1]||(t[1]=e=>Q.regAgency())},"등록")])])])]),(0,i._)("div",y,[(0,i._)("div",v,[_,f,(0,i._)("div",w,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.travelCity=t)},b,512),[[s.bM,e.travelCity]])])]),(0,i._)("div",P,[I,k,(0,i.wy)((0,i._)("input",{type:"text",style:{width:"80px"},"onUpdate:modelValue":t[3]||(t[3]=t=>e.personCount=t)},null,512),[[s.nr,e.personCount]])]),(0,i._)("div",D,[$,A,(0,i.wy)((0,i._)("input",{type:"date",min:e.minDate,"onUpdate:modelValue":t[4]||(t[4]=t=>e.startDate=t)},null,8,S),[[s.nr,e.startDate]])]),(0,i._)("div",U,[x,T,E,(0,i.wy)((0,i._)("input",{type:"text",style:{width:"80px"},"onUpdate:modelValue":t[5]||(t[5]=t=>e.realPay=t)},null,512),[[s.nr,e.realPay]]),L,(0,i.wy)((0,i._)("input",{type:"text",style:{width:"80px"},"onUpdate:modelValue":t[6]||(t[6]=t=>e.salePercent=t)},null,512),[[s.nr,e.salePercent]]),F,(0,i._)("div",M," 현재 가격: "+(0,n.zw)(e.$numberWithCommas(e.salePay))+" 원 ",1)]),(0,i._)("div",R,[V,q,(0,i.wy)((0,i._)("input",{type:"date",min:e.minDate,"onUpdate:modelValue":t[7]||(t[7]=t=>e.endDate=t)},null,8,z),[[s.nr,e.endDate]])]),"SUPER"==e.adminAuth?((0,i.wg)(),(0,i.iD)("div",B,[H,Z,(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.agencyId=t)},[j,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.travelAgencyList,((e,t)=>((0,i.wg)(),(0,i.iD)("option",{key:t,value:e.id},(0,n.zw)(e.name),9,K)))),128))],512),[[s.bM,e.agencyId]])])):(0,i.kq)("",!0),(0,i._)("div",Y,[(0,i._)("label",O,[(0,i._)("input",{class:"file",id:"chooseFile",type:"file",onClick:t[9]||(t[9]=(...e)=>Q.resetImageUploader&&Q.resetImageUploader(...e)),onChange:t[10]||(t[10]=(...e)=>Q.upload&&Q.upload(...e)),accept:"image/png, image/jpeg, image/gif",ref:"imageUploader"},null,544),W,(0,i._)("h4",null,[G,(0,i._)("button",{style:{"margin-left":"1rem"},type:"button",class:"btn btn-primary",onClick:t[11]||(t[11]=e=>Q.resetImage())},"썸네일 삭제")])])]),""!=e.preview?((0,i.wg)(),(0,i.iD)("div",J,[(0,i._)("img",{src:e.preview,style:{width:"100%",height:"100%"}},null,8,N)])):(0,i.kq)("",!0)])])])])}var X=a(1584),ee={data:function(){return{travelAgencyId:0,contentChange:"",travelTitle:"",travelCity:"",preview:"",file:"",saveThumbnail_id:"",agencyComment:"",roadAddress:"",aa:!1,personCount:"",minDate:"",startDate:"",realPay:"",salePay:"",salePercent:"",adminAuth:"",travelAgencyList:[],agencyId:0,endDate:"",test:!1,content:"",fileId:""}},components:{ToastEditor:X.Z},created(){this.travelAgencyId=this.$route.query.sn,this.dateInit(),this.authChk(),this.validTravel()},methods:{authChk(){const e={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/admin/auth",{headers:e}).then((e=>{"SUCCESS"==e.data.resultCode&&(this.agencyId=e.data.result.agencyId,this.adminAuth=e.data.result.role,"SUPER"==this.adminAuth&&this.traveAgencyList())})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{}))},traveAgencyList(){const e={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/admin/list",{headers:e}).then((e=>{"SUCCESS"==e.data.resultCode&&(this.travelAgencyList=[],e.data.result.forEach((e=>{let t=[];t.name=e.name,t.id=e.id,this.travelAgencyList.push(t)})))})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{}))},validTravel(){this.loading=!0;const e={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/agency-trip/"+this.travelAgencyId,{headers:e}).then((t=>{if("SUCCESS"==t.data.resultCode){let a=t.data.result;this.travelTitle=a.title,this.content=a.content,this.contentChange=a.content,this.travelCity=a.city,this.personCount=a.person_max_count,this.startDate=a.travelRealTripAt.substr(0,4)+"-"+a.travelRealTripAt.substr(4,2)+"-"+a.travelRealTripAt.substr(6,2),this.realPay=a.real_paid,this.salePercent=a.sale_percent,this.salePay=a.sale_paid,this.endDate=a.travel_end_at.substr(0,4)+"-"+a.travel_end_at.substr(4,2)+"-"+a.travel_end_at.substr(6,2),this.agencyId=a.travel_agency_id,this.fileId=a.thumnbnailFileId,null!=a.thumnbnailFileId&&this.$axios.get("/api/common/image/"+a.thumnbnailFileId+"/1",{headers:e}).then((e=>{this.preview=e.data})).catch((()=>{})).finally((()=>{}))}})).catch((e=>{this.$swal("",e.response.data.result,"error"),this.$router.push("/travelList")})).finally((()=>{this.test=!0}))},dateInit(){let e=new Date,t=String(e.getFullYear()),a=String(e.getMonth()+1<10?"0"+e.getMonth()+1:e.getMonth()+1),i=String(e.getDate()<10?"0"+e.getDate():e.getDate());this.minDate=t+"-"+a+"-"+i},editorContent(e){this.contentChange=e},async regAgency(){const e={Authorization:"Bearer "+sessionStorage.getItem("token")};var t=this.contentChange;if(t=t.replace(/&nbsp;/gi,""),t=t.replace(/<br>/gi,""),t=t.replace(/ /gi,""),this.$emptyChk(this.travelTitle))return void this.$swal("","제목 을 입력해주세요.","warning");if(this.$emptyChk(this.travelCity))return void this.$swal("","도시 입력해주세요.","warning");if(""==this.personCount)return void this.$swal("","인원을 입력해주세요.","warning");if(""==this.startDate)return void this.$swal("","출발일을 입력해주세요.","warning");if(""==this.salePay)return void this.$swal("","가격을 입력해주세요.","warning");if(""==this.endDate)return void this.$swal("","마감일을 입력해주세요.","warning");if(0==this.agencyId)return void this.$swal("","여행사를 입력해주세요.","warning");if("<p></p>"==t||""==t)return void this.$swal("","내용을 입력해주세요.","warning");if(""!=this.file||void 0!=this.file){const e={"content-type":"multipart/form-data"},t=new FormData;t.append("multiFile",this.file),await this.$axios.post("/api/common/file-upload",t,{imageheaders:e}).then((e=>{this.fileId=e.data[0].fileId})).catch((()=>{})).finally((()=>{}))}let a={travel_agency_id:this.agencyId,city:this.travelCity,content:this.contentChange,person_max_count:this.personCount,real_paid:this.realPay,sale_paid:this.salePay,sale_percent:this.salePercent,title:this.travelTitle,travel_end_at:this.endDate.replace(/\-/g,""),travelRealTripAt:this.startDate.replace(/\-/g,""),thumnbnailFileId:this.fileId};await this.$axios.put("/api/adm/agency-trip/"+this.travelAgencyId+"/form",a,{headers:e}).then((e=>{"SUCCESS"==e.data.resultCode&&(this.$swal("","저장되었습니다.","success"),this.$router.push("/travelList"))})).catch((e=>(this.$swal("",e.response.data.result,"error"),!1))).finally((()=>{}))},upload(e){this.file=e.target.files[0];var t=URL.createObjectURL(this.file);this.preview=t},resetImageUploader(){this.$refs.imageUploader.value=""},resetImage(){this.file="",this.preview="",this.$refs.imageUploader.value=""},address(){new window.daum.Postcode({oncomplete:e=>{this.roadAddress=e.roadAddress}}).open()}},watch:{personCount(){let e=/^[0-9]+$/;e.test(this.personCount)||(this.personCount=""),this.personCount.length>5&&(this.personCount="")},realPay(){""!=this.salePercent&&0!=this.salePercent?""==this.realPay?this.salePay=this.realPay:this.salePay=Math.floor(parseInt(this.realPay)-parseInt(this.realPay)*(this.salePercent/100)):this.salePay=this.realPay},salePercent(){let e=/^[0-9]+$/;e.test(this.salePercent)||(this.salePercent=""),this.salePercent>100&&(this.salePercent=""),""!=this.realPay&&""!=this.realPay&&(this.salePay=Math.floor(parseInt(this.realPay)-parseInt(this.realPay)*(this.salePercent/100)))}}},te=a(89);const ae=(0,te.Z)(ee,[["render",Q],["__scopeId","data-v-04a10dbe"]]);var ie=ae}}]);
//# sourceMappingURL=395.bac2424b.js.map