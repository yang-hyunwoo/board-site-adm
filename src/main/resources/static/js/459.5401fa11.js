"use strict";(self["webpackChunkboard_site_front"]=self["webpackChunkboard_site_front"]||[]).push([[459],{1584:function(t,e,a){a.d(e,{Z:function(){return o}});var i=a(3396),s=a(6171),n=a(4870),l={__name:"ToastModifyEditor",props:{content:{type:String,required:!0}},emits:["contentChange"],setup(t,{emit:e}){const l=t,r=(0,n.iH)(null),o=a(6265);return(0,i.bv)((()=>{const t=new s.ZP({el:r.value,height:"500px",initialValue:l.content,initialEditType:"wysiwyg",previewStyle:"tab",useDefaultHTMLSanitizer:!1,language:"ko-KR",usageStatistics:!1,hideModeSwitch:!0,hooks:{addImageBlobHook:(t,e)=>{const a={"content-type":"multipart/form-data"},i=new FormData;i.append("multiFile",t),o.post("/api/common/file-upload",i,{headers:a}).then((t=>{e(t.data[0].filePath)})).catch((()=>{})).finally((()=>{}))}},events:{change:()=>e("contentChange",t.getHTML())},toolbarItems:[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task"],["table","image","link"],["scrollSync"]]})})),(t,e)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"refEditor",ref:r},null,512))}};const r=l;var o=r},7459:function(t,e,a){a.r(e),a.d(e,{default:function(){return it}});var i=a(3396),s=a(9242),n=a(7139);const l=t=>((0,i.dD)("data-v-1a1fa554"),t=t(),(0,i.Cn)(),t),r={id:"contact",class:"contact-area section-padding"},o={class:"container"},d={class:"row"},h={class:"col-lg-7"},c={class:"contact"},u={class:"row",style:{"margin-top":"2rem"}},p={class:"form-group col-md-12"},g={class:"form-group col-md-12",style:{"margin-top":"1rem"}},m={class:"col-md-12 text-center",style:{"margin-top":"1rem"}},y={class:"col-lg-5",style:{"margin-top":"2rem"}},v={class:"single_address"},f=l((()=>(0,i._)("i",{class:"fa fa-map-marker"},null,-1))),_=l((()=>(0,i._)("h4",null,"도시 ",-1))),w={style:{"margin-top":"10px"}},C=(0,i.uE)('<option value="" data-v-1a1fa554>선택</option><option value="서울" data-v-1a1fa554>서울</option><option value="부산" data-v-1a1fa554>부산</option><option value="울산" data-v-1a1fa554>울산</option><option value="대구" data-v-1a1fa554>대구</option><option value="대전" data-v-1a1fa554>대전</option><option value="제주" data-v-1a1fa554>제주</option>',7),b=[C],P={class:"single_address"},I=l((()=>(0,i._)("i",{class:"fa fa-user"},null,-1))),k=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"인원",-1))),D={class:"single_address"},$=l((()=>(0,i._)("i",{class:"fa fa-plane"},null,-1))),A=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"출발일",-1))),S=["min"],U={class:"single_address"},x=l((()=>(0,i._)("i",{class:"fa fa-money"},null,-1))),T=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"가격",-1))),E=(0,i.Uk)(" 원가: "),L=(0,i.Uk)(" 할인율: "),F=l((()=>(0,i._)("br",null,null,-1))),M={style:{"margin-top":"12px"}},R={class:"single_address"},V=l((()=>(0,i._)("i",{class:"fa fa-calendar"},null,-1))),q=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"마감일",-1))),z=["min"],B={key:0,class:"single_address"},H=l((()=>(0,i._)("i",{class:"fa fa-list"},null,-1))),Z=l((()=>(0,i._)("h4",{style:{"margin-bottom":"1rem"}},"여행사",-1))),j=l((()=>(0,i._)("option",{selected:"",value:"0"},"선택하세요",-1))),K=["value"],Y={class:"single_address"},O={class:"file-label",for:"chooseFile"},W=l((()=>(0,i._)("i",{class:"fa fa-image"},null,-1))),G=(0,i.Uk)("썸네일 "),J={key:1,style:{width:"400px",height:"250px"}},N=["src"];function Q(t,e,a,l,C,Q){const X=(0,i.up)("ToastEditor");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("div",o,[(0,i._)("div",d,[(0,i._)("div",h,[(0,i._)("div",c,[(0,i._)("div",u,[(0,i._)("div",p,[(0,i.wy)((0,i._)("input",{type:"text",name:"name",class:"form-control",placeholder:"제목을 입력하세요",required:"required","onUpdate:modelValue":e[0]||(e[0]=e=>t.travelTitle=e)},null,512),[[s.nr,t.travelTitle]])]),(0,i._)("div",g,[t.test?((0,i.wg)(),(0,i.j4)(X,{key:0,onContentChange:Q.editorContent,content:t.content},null,8,["onContentChange","content"])):(0,i.kq)("",!0)]),(0,i._)("div",m,[(0,i._)("button",{class:"btn btn-contact-bg",onClick:e[1]||(e[1]=t=>Q.regAgency())},"등록")])])])]),(0,i._)("div",y,[(0,i._)("div",v,[f,_,(0,i._)("div",w,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.travelCity=e)},b,512),[[s.bM,t.travelCity]])])]),(0,i._)("div",P,[I,k,(0,i.wy)((0,i._)("input",{type:"text",style:{width:"80px"},"onUpdate:modelValue":e[3]||(e[3]=e=>t.personCount=e)},null,512),[[s.nr,t.personCount]])]),(0,i._)("div",D,[$,A,(0,i.wy)((0,i._)("input",{type:"date",min:t.minDate,"onUpdate:modelValue":e[4]||(e[4]=e=>t.startDate=e)},null,8,S),[[s.nr,t.startDate]])]),(0,i._)("div",U,[x,T,E,(0,i.wy)((0,i._)("input",{type:"text",style:{width:"80px"},"onUpdate:modelValue":e[5]||(e[5]=e=>t.realPay=e)},null,512),[[s.nr,t.realPay]]),L,(0,i.wy)((0,i._)("input",{type:"text",style:{width:"80px"},"onUpdate:modelValue":e[6]||(e[6]=e=>t.salePercent=e)},null,512),[[s.nr,t.salePercent]]),F,(0,i._)("div",M," 현재 가격: "+(0,n.zw)(t.$numberWithCommas(t.salePay))+" 원 ",1)]),(0,i._)("div",R,[V,q,(0,i.wy)((0,i._)("input",{type:"date",min:t.minDate,"onUpdate:modelValue":e[7]||(e[7]=e=>t.endDate=e)},null,8,z),[[s.nr,t.endDate]])]),"SUPER"==t.adminAuth?((0,i.wg)(),(0,i.iD)("div",B,[H,Z,(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":e[8]||(e[8]=e=>t.agencyId=e)},[j,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.travelAgencyList,((t,e)=>((0,i.wg)(),(0,i.iD)("option",{key:e,value:t.id},(0,n.zw)(t.name),9,K)))),128))],512),[[s.bM,t.agencyId]])])):(0,i.kq)("",!0),(0,i._)("div",Y,[(0,i._)("label",O,[(0,i._)("input",{class:"file",id:"chooseFile",type:"file",onClick:e[9]||(e[9]=(...t)=>Q.resetImageUploader&&Q.resetImageUploader(...t)),onChange:e[10]||(e[10]=(...t)=>Q.upload&&Q.upload(...t)),accept:"image/png, image/jpeg, image/gif",ref:"imageUploader"},null,544),W,(0,i._)("h4",null,[G,(0,i._)("button",{style:{"margin-left":"1rem"},type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=t=>Q.resetImage())},"썸네일 삭제")])])]),""!=t.preview?((0,i.wg)(),(0,i.iD)("div",J,[(0,i._)("img",{src:t.preview,style:{width:"100%",height:"100%"}},null,8,N)])):(0,i.kq)("",!0)])])])])}var X=a(1584),tt={data:function(){return{travelAgencyId:0,contentChange:"",travelTitle:"",travelCity:"",preview:"",file:"",saveThumbnail_id:"",agencyComment:"",roadAddress:"",aa:!1,personCount:"",minDate:"",startDate:"",realPay:"",salePay:"",salePercent:"",adminAuth:"",travelAgencyList:[],agencyId:0,endDate:"",test:!1,content:"",fileId:""}},components:{ToastEditor:X.Z},created(){this.travelAgencyId=this.$route.query.sn,this.dateInit(),this.authChk(),this.validTravel()},methods:{authChk(){const t={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/admin/auth",{headers:t}).then((t=>{"SUCCESS"==t.data.resultCode&&(this.agencyId=t.data.result.agencyId,this.adminAuth=t.data.result.role,"SUPER"==this.adminAuth&&this.traveAgencyList())})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{}))},traveAgencyList(){const t={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/admin/list",{headers:t}).then((t=>{"SUCCESS"==t.data.resultCode&&(this.travelAgencyList=[],t.data.result.forEach((t=>{let e=[];e.name=t.name,e.id=t.id,this.travelAgencyList.push(e)})))})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{}))},validTravel(){this.loading=!0;const t={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/agency-trip/"+this.travelAgencyId,{headers:t}).then((t=>{if("SUCCESS"==t.data.resultCode){let e=t.data.result;this.travelTitle=e.title,this.content=e.content,this.contentChange=e.content,this.travelCity=e.city,this.personCount=e.person_max_count,this.startDate=e.travelRealTripAt.substr(0,4)+"-"+e.travelRealTripAt.substr(4,2)+"-"+e.travelRealTripAt.substr(6,2),this.realPay=e.real_paid,this.salePercent=e.sale_percent,this.salePay=e.sale_paid,this.endDate=e.travel_end_at.substr(0,4)+"-"+e.travel_end_at.substr(4,2)+"-"+e.travel_end_at.substr(6,2),this.agencyId=e.travel_agency_id,this.fileId=e.thumnbnailFileId,null!=e.thumnbnailFileId&&(this.preview="/api/common/image/"+e.thumnbnailFileId+"/1")}})).catch((t=>{this.$swal("",t.response.data.result,"error"),this.$router.push("/travelList")})).finally((()=>{this.test=!0}))},dateInit(){let t=new Date,e=String(t.getFullYear()),a=String(t.getMonth()+1<10?"0"+t.getMonth()+1:t.getMonth()+1),i=String(t.getDate()<10?"0"+t.getDate():t.getDate());this.minDate=e+"-"+a+"-"+i},editorContent(t){this.contentChange=t},async regAgency(){const t={Authorization:"Bearer "+sessionStorage.getItem("token")};var e=this.contentChange;if(e=e.replace(/&nbsp;/gi,""),e=e.replace(/<br>/gi,""),e=e.replace(/ /gi,""),this.$emptyChk(this.travelTitle))return void this.$swal("","제목 을 입력해주세요.","warning");if(this.$emptyChk(this.travelCity))return void this.$swal("","도시 입력해주세요.","warning");if(""==this.personCount)return void this.$swal("","인원을 입력해주세요.","warning");if(""==this.startDate)return void this.$swal("","출발일을 입력해주세요.","warning");if(""==this.salePay)return void this.$swal("","가격을 입력해주세요.","warning");if(""==this.endDate)return void this.$swal("","마감일을 입력해주세요.","warning");if(0==this.agencyId)return void this.$swal("","여행사를 입력해주세요.","warning");if("<p></p>"==e||""==e)return void this.$swal("","내용을 입력해주세요.","warning");if(""!=this.file||void 0!=this.file){const t={"content-type":"multipart/form-data"},e=new FormData;e.append("multiFile",this.file),await this.$axios.post("/api/common/file-upload",e,{imageheaders:t}).then((t=>{this.fileId=t.data[0].fileId})).catch((()=>{})).finally((()=>{}))}let a={travel_agency_id:this.agencyId,city:this.travelCity,content:this.contentChange,person_max_count:this.personCount,real_paid:this.realPay,sale_paid:this.salePay,sale_percent:this.salePercent,title:this.travelTitle,travel_end_at:this.endDate.replace(/\-/g,""),travelRealTripAt:this.startDate.replace(/\-/g,""),thumnbnailFileId:this.fileId};await this.$axios.put("/api/adm/agency-trip/"+this.travelAgencyId+"/form",a,{headers:t}).then((t=>{"SUCCESS"==t.data.resultCode&&(this.$swal("","저장되었습니다.","success"),this.$router.push("/travelList"))})).catch((t=>(this.$swal("",t.response.data.result,"error"),!1))).finally((()=>{}))},upload(t){this.file=t.target.files[0];var e=URL.createObjectURL(this.file);this.preview=e},resetImageUploader(){this.$refs.imageUploader.value=""},resetImage(){this.file="",this.preview="",this.$refs.imageUploader.value=""},address(){new window.daum.Postcode({oncomplete:t=>{this.roadAddress=t.roadAddress}}).open()}},watch:{personCount(){let t=/^[0-9]+$/;t.test(this.personCount)||(this.personCount=""),this.personCount.length>5&&(this.personCount="")},realPay(){""!=this.salePercent&&0!=this.salePercent?""==this.realPay?this.salePay=this.realPay:this.salePay=Math.floor(parseInt(this.realPay)-parseInt(this.realPay)*(this.salePercent/100)):this.salePay=this.realPay},salePercent(){let t=/^[0-9]+$/;t.test(this.salePercent)||(this.salePercent=""),this.salePercent>100&&(this.salePercent=""),""!=this.realPay&&""!=this.realPay&&(this.salePay=Math.floor(parseInt(this.realPay)-parseInt(this.realPay)*(this.salePercent/100)))}}},et=a(89);const at=(0,et.Z)(tt,[["render",Q],["__scopeId","data-v-1a1fa554"]]);var it=at}}]);
//# sourceMappingURL=459.5401fa11.js.map