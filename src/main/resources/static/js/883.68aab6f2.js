"use strict";(self["webpackChunkboard_site_front"]=self["webpackChunkboard_site_front"]||[]).push([[883],{360:function(t,e,a){a.d(e,{Z:function(){return p}});var s=a(3396);const l={class:"pagination"},i={class:"overflow-auto"},r={class:"mt-3"};function n(t,e,a,n,o,d){const c=(0,s.up)("b-pagination"),p=(0,s.up)("b-card");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s.Wm)(p,{style:{"justify-content":"center"}},{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s._)("div",r,[(0,s.Wm)(c,{modelValue:t.ex4CurrentPage,"onUpdate:modelValue":e[0]||(e[0]=e=>t.ex4CurrentPage=e),pills:"","total-rows":t.ex4Rows,onPageClick:d.pageClick,"per-page":t.perPage,currPage:a.currPage},null,8,["modelValue","total-rows","onPageClick","per-page","currPage"])])])])),_:1}),(0,s.WI)(t.$slots,"default")])}var o={props:{pageListItem:Number,pageTotal:Number,currPage:{type:Number,default:1}},data:function(){return{ex4CurrentPage:this.currPage,ex4Rows:this.pageTotal,perPage:this.pageListItem}},created(){console.log(this.currPage)},methods:{pageClick:function(t,e){this.ex4CurrentPage=e,this.$emit("pageCurrent",this.ex4CurrentPage)}}},d=a(89);const c=(0,d.Z)(o,[["render",n]]);var p=c},5033:function(t,e,a){a.d(e,{Z:function(){return c}});var s=a(3396);const l=(0,s._)("div",{class:"customdis"},[(0,s._)("div",{class:"spinner-border text-secondary",style:{width:"3rem",height:"3rem"},role:"status"},[(0,s._)("span",{class:"visually-hidden"},"Loading...")])],-1),i=[l];function r(t,e,a,l,r,n){return(0,s.wg)(),(0,s.iD)("div",{class:"black-bg",onClick:e[0]||(e[0]=e=>t.$emit("close"))},i)}var n={},o=a(89);const d=(0,o.Z)(n,[["render",r]]);var c=d},4883:function(t,e,a){a.r(e),a.d(e,{default:function(){return vt}});var s=a(3396),l=a(9242),i=a(7139);const r={class:"py-5 text-center container"},n={class:"row py-5"},o={class:"col-lg-12 mx-auto"},d={class:"text-white p-5 shadow-sm rounded banner"},c=(0,s._)("h1",{class:"display-4"},"여행 리스트",-1),p=(0,s._)("option",{selected:"",value:"CREATEDAT"},"작성일",-1),u=(0,s._)("option",{value:"STARTAT"},"출발일",-1),h=[p,u],g=(0,s.Uk)(" ~ "),m=(0,s._)("option",{selected:"",value:"TITLE"},"제목",-1),_=(0,s._)("option",{value:"AGENCYNAME"},"여행사",-1),y=[m,_],b={class:"container"},w={class:"row py-5"},k={class:"mb-3"},C={class:"card-title"},v=(0,s.Uk)("목록 "),f={class:"text-muted fw-normal ms-2"},S={class:"row"},D={class:"col-lg-12"},x={class:""},P={class:"table-responsive"},A={class:"table project-list-table table-nowrap align-middle table-borderless"},z=(0,s._)("th",{scope:"col"},"제목",-1),E=(0,s._)("th",{scope:"col"},"도시",-1),T=(0,s._)("th",{scope:"col"},"여행사",-1),$=(0,s._)("th",{scope:"col"},"가격/할인율/할인가격",-1),L=(0,s._)("th",{scope:"col"},"구매인원/총인원",-1),U=(0,s._)("th",{scope:"col"},"등록일~종료일",-1),I=(0,s._)("th",{scope:"col"},"출발일",-1),M={key:0,scope:"col"},R=(0,s._)("th",{scope:"col"},"종료여부",-1),q=(0,s._)("th",{scope:"col",style:{width:"200px"}},"변경",-1),B={key:1,scope:"col"},V=["onClick"],N=["src"],W={class:"text-body"},Z={class:"badge badge-soft-info mb-0"},Y={class:"badge badge-soft-primary mb-0"},j={class:"badge badge-soft-danger mb-0"},H={key:0},O={key:0,class:"badge badge-soft-danger mb-0"},F={key:1,class:"badge badge-soft-info mb-0"},G={class:"list-inline mb-0"},K={class:"list-inline-item"},J=["onClick"],Q=(0,s._)("i",{class:"bx bx-pencil font-size-18"},null,-1),X=[Q],tt={class:"list-inline-item"},et=["onClick"],at=(0,s._)("i",{class:"bx bx-trash-alt font-size-18"},null,-1),st=[at],lt={class:"list-inline-item dropdown"},it=(0,s._)("a",{class:"text-muted dropdown-toggle font-size-18 px-2",href:"#",role:"button","data-bs-toggle":"dropdown","aria-haspopup":"true"},[(0,s._)("i",{class:"bx bx-dots-vertical-rounded"})],-1),rt={class:"dropdown-menu dropdown-menu-end"},nt=["onClick"],ot=["onClick"],dt=["onClick"],ct={key:1},pt={class:"list-inline-item"},ut=["onUpdate:modelValue"],ht=(0,s.uE)('<option value="">선택</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>',6),gt=[ht],mt=["onClick"];function _t(t,e,a,p,u,m){const _=(0,s.up)("BlackBg"),Q=(0,s.up)("Pagination");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("section",r,[(0,s._)("div",n,[(0,s._)("div",o,[(0,s._)("div",d,[c,(0,s.wy)((0,s._)("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":e[0]||(e[0]=e=>t.date_type=e),style:{"margin-right":"1rem"}},h,512),[[l.bM,t.date_type]]),(0,s.wy)((0,s._)("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=e=>t.startDate=e)},null,512),[[l.nr,t.startDate]]),g,(0,s.wy)((0,s._)("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=e=>t.endDate=e)},null,512),[[l.nr,t.endDate]]),(0,s.wy)((0,s._)("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":e[3]||(e[3]=e=>t.search_type=e),style:{"margin-left":"1rem"}},y,512),[[l.bM,t.search_type]]),(0,s.wy)((0,s._)("input",{class:"form-control mr-sm-2 custombar",type:"search",placeholder:"제목을 입력해주세요.","aria-label":"Search","onUpdate:modelValue":e[4]||(e[4]=e=>t.travel_title=e),onKeyup:e[5]||(e[5]=(0,l.D2)(((...t)=>m.travelSearch&&m.travelSearch(...t)),["enter"])),style:{"margin-left":"1rem"}},null,544),[[l.nr,t.travel_title]]),(0,s._)("button",{class:"btn btn-outline-success my-2 my-sm-0",style:{"margin-left":"1rem"},onClick:e[6]||(e[6]=(...t)=>m.travelSearch&&m.travelSearch(...t))},"Search")])])]),(0,s._)("button",{style:{float:"right","margin-left":"10px"},type:"button",class:"btn btn-primary",onClick:e[7]||(e[7]=t=>m.agencyExcel())},"엑셀"),(0,s._)("button",{style:{float:"right"},type:"button",class:"btn btn-primary",onClick:e[8]||(e[8]=t=>m.travelWriteClick())},"신규등록")]),(0,s._)("div",b,[(0,s._)("div",w,[(0,s._)("div",k,[(0,s._)("h5",C,[v,(0,s._)("span",f,(0,i.zw)(t.startPage)+" to "+(0,i.zw)(t.endPage)+" of "+(0,i.zw)(t.totalList),1)])]),(0,s._)("div",S,[(0,s._)("div",D,[(0,s._)("div",x,[(0,s._)("div",P,[(0,s._)("table",A,[(0,s._)("thead",null,[(0,s._)("tr",null,[z,E,T,$,L,U,I,"SUPER"==t.adminAuth?((0,s.wg)(),(0,s.iD)("th",M,"정렬 순서")):(0,s.kq)("",!0),R,q,"SUPER"==t.adminAuth?((0,s.wg)(),(0,s.iD)("th",B,"정렬")):(0,s.kq)("",!0)])]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.travel_list,((e,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a},[(0,s._)("td",{onClick:t=>m.todoCclick(e.id),style:{cursor:"pointer"}},[e.img_real?((0,s.wg)(),(0,s.iD)("img",{key:0,src:e.img,alt:"",class:"avatar-sm rounded-circle me-2"},null,8,N)):(0,s.kq)("",!0),(0,s._)("a",W,(0,i.zw)(e.title),1)],8,V),(0,s._)("td",null,(0,i.zw)(e.city),1),(0,s._)("td",null,(0,i.zw)(e.travelAgencyName),1),(0,s._)("td",null,[(0,s._)("span",Z,(0,i.zw)(e.real_pay),1),(0,s._)("span",Y,(0,i.zw)(e.sale_percent),1),(0,s._)("span",j,(0,i.zw)(e.sale_pay),1)]),(0,s._)("td",null,(0,i.zw)(e.personCount)+"명/"+(0,i.zw)(e.personMaxCount)+"명",1),(0,s._)("td",null,(0,i.zw)(e.start_de)+"~"+(0,i.zw)(e.end_de),1),(0,s._)("td",null,(0,i.zw)(e.trip_start_de),1),"SUPER"==t.adminAuth?((0,s.wg)(),(0,s.iD)("td",H,(0,i.zw)(e.sort),1)):(0,s.kq)("",!0),(0,s._)("td",null,["종료"==e.deleted?((0,s.wg)(),(0,s.iD)("span",O,(0,i.zw)(e.deleted),1)):(0,s.kq)("",!0),"진행 중"==e.deleted?((0,s.wg)(),(0,s.iD)("span",F,(0,i.zw)(e.deleted),1)):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s._)("ul",G,[(0,s._)("li",K,[(0,s._)("a",{onClick:t=>m.updateClick(e.id),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Edit",class:"px-2 text-primary",style:{cursor:"pointer"}},X,8,J)]),(0,s._)("li",tt,[(0,s._)("a",{onClick:t=>m.deleteClick(e.id,e.deleted),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Delete",class:"px-2 text-danger",style:{cursor:"pointer"}},st,8,et)]),(0,s._)("li",lt,[it,(0,s._)("div",rt,[(0,s._)("a",{class:"dropdown-item",onClick:t=>m.updateClick(e.id),style:{cursor:"pointer"}},"수정",8,nt),(0,s._)("a",{class:"dropdown-item",onClick:t=>m.deleteClick(e.id,e.deleted),style:{cursor:"pointer"}},"삭제",8,ot),(0,s._)("a",{class:"dropdown-item",onClick:t=>m.reDeleteClick(e.id,e.deleted)},"재등록",8,dt)])])])]),"SUPER"==t.adminAuth?((0,s.wg)(),(0,s.iD)("td",ct,[(0,s._)("li",pt,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":e=>t.formSort.newSort[a]=e},gt,8,ut),[[l.bM,t.formSort.newSort[a]]]),(0,s._)("button",{class:"btn btn-primary",style:{"margin-left":"3px",height:"35px"},onClick:t=>m.sortClcik(e.id,a)},"적용",8,mt)])])):(0,s.kq)("",!0)])))),128))])])])])])]),t.loading?((0,s.wg)(),(0,s.j4)(_,{key:0})):(0,s.kq)("",!0),t.pageChk?((0,s.wg)(),(0,s.j4)(Q,{key:1,pageListItem:t.pageListItem,onPageCurrent:m.pageCurr,pageTotal:t.pageTotal},null,8,["pageListItem","onPageCurrent","pageTotal"])):(0,s.kq)("",!0)])])],64)}var yt=a(360),bt=a(5033),wt={data:function(){return{pageListItem:10,page:0,travel_title:"",pageTotal:0,pageChk:!1,travel_list:[],loading:!1,search_type:"TITLE",date_type:"CREATEDAT",startDate:"",startDateSplit:"",endDate:"",endDateSplit:"",adminAuth:"",startPage:"",endPage:"",totalList:"",travelAgencyListSort:"",formSort:{newSort:["","","","","","","","","",""]}}},components:{Pagination:yt.Z,BlackBg:bt.Z},created(){this.init()},methods:{init(){this.dateInit(),this.travelList(),this.authChk()},authChk(){const t={Authorization:"Bearer "+sessionStorage.getItem("token")};this.$axios.get("/api/adm/admin/auth",{headers:t}).then((t=>{"SUCCESS"==t.data.resultCode&&(this.adminAuth=t.data.result.role)})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{}))},dateInit(){let t=new Date,e=String(t.getFullYear()),a=String(t.getMonth()+1<10?0+t.getMonth()+1:t.getMonth()+1),s=String(t.getDate()<10?"0"+t.getDate():t.getDate());if(void 0==this.$route.query.sn)a<10&&(a="0"+a,console.log(a)),this.startDate=e+"-"+a+"-01",this.startDateSplit=e+a+"01",this.endDate=e+"-"+a+"-"+s,this.endDateSplit=e+a+s;else{this.date_type="STARTAT";let t=this.$route.query.sn;this.startDate=t,this.startDateSplit=t.substr(0,4)+t.substr(5,2)+t.substr(8),this.endDate=this.startDate,this.endDateSplit=this.startDateSplit}},travelList(){this.formSort.newSort=["","","","","","","","","",""];const t={Authorization:"Bearer "+sessionStorage.getItem("token")};let e={page:this.page,inputSearch:this.search_type,dateSearch:this.date_type,startedAt:this.startDate,endAt:this.endDate,input:this.travel_title};this.loading=!0,this.$axios.get("/api/adm/agency-trip/triplist",{headers:t,params:e}).then((t=>{"SUCCESS"==t.data.resultCode&&(this.pageTotal=t.data.result.totalElements,console.log(t),this.totalList=t.data.result.totalElements,this.startPage=t.data.result.number*t.data.result.size+1,t.data.result.numberOfElements==t.data.result.size?this.endPage=(t.data.result.number+1)*t.data.result.size:this.endPage=t.data.result.number*t.data.result.size+t.data.result.numberOfElements,this.travel_list=[],t.data.result.content.forEach((t=>{let e=[];e.title=t.title.substr(0,6),e.travelAgencyName=t.travelAgencyName,e.id=t.id,e.city=t.city,e.start_de=this.$splitDateHyphen(t.travel_start_at),e.end_de=this.$splitDateHyphen(t.travel_end_at),e.trip_start_de=this.$splitDateHyphen(t.travelRealTripAt),e.real_pay=t.real_paid+"원",e.sale_percent=t.sale_percent+"%",e.sale_pay=t.sale_paid+"원",e.personCount=t.person_count,e.personMaxCount=t.person_max_count,e.sort=t.sort,t.deleted?e.deleted="종료":e.deleted="진행 중",null==t.filePath||""==t.filePath?e.img_real=!1:(e.img_real=!0,e.img=t.filePath),this.travel_list.push(e)})))})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{this.pageChk=!0,this.loading=!1}))},deleteClick(t,e){if("진행 중"==e){const e={Authorization:"Bearer "+sessionStorage.getItem("token")};this.loading=!0,this.$axios.put("/api/adm/agency-trip/"+t+"/delete","",{headers:e}).then((t=>{"SUCCESS"==t.data.resultCode&&this.travelList()})).catch((t=>{this.$swal("",t.response.data.result,"error")})).finally((()=>{this.loading=!1}))}else this.$swal("","이미 종료된 여행 입니다.","warning")},reDeleteClick(t,e){if("종료"==e){const e={Authorization:"Bearer "+sessionStorage.getItem("token")};this.loading=!0,this.$axios.put("/api/adm/agency-trip/"+t+"/re-delete","",{headers:e}).then((t=>{"SUCCESS"==t.data.resultCode&&this.travelList()})).catch((t=>{this.$swal("",t.response.data.result,"error")})).finally((()=>{this.loading=!1}))}else this.$swal("","이미 사용중인 여행사 입니다.","warning")},sortClcik(t,e){let a=this.formSort.newSort[e];""!=a&&null!=a||(a=0);const s={Authorization:"Bearer "+sessionStorage.getItem("token")};this.loading=!0,this.$axios.put("/api/adm/agency-trip/"+t+"/"+a+"/sort","",{headers:s}).then((t=>{"SUCCESS"==t.data.resultCode&&this.travelList()})).catch((t=>{this.$swal("",t.response.data.result,"error")})).finally((()=>{this.loading=!1}))},pageCurr(t){this.page=t-1,this.travelList()},travelSearch(){this.page=0,this.pageChk=!1,this.travelList()},travelWriteClick(){this.$router.push({path:"/TravelWrite",name:"travelWrite"})},todoCclick(t){this.$router.push({path:"/TravelDetail",name:"travelDetail",query:{sn:t}})},updateClick(t){this.$router.push({path:"/travelModify",name:"travelModify",query:{sn:t}})},agencyExcel(){let t=new Date,e=String(t.getFullYear()),a=String(t.getMonth()+1<10?"0"+t.getMonth()+1:t.getMonth()+1),s=String(t.getDate()<10?"0"+t.getDate():t.getDate()),l=e+"-"+a+"-"+s;const i={Authorization:"Bearer "+sessionStorage.getItem("token")};let r={excelType:"TRAVELAGENCYLIST"};this.$axios.get("/api/adm/excel/excel",{headers:i,responseType:"blob",params:r}).then((t=>{const e=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=e,a.setAttribute("download",l+"_여행 목록.xls"),document.body.appendChild(a),a.click()})).catch((()=>{this.$swal("","잠시후 다시 이용해주세요.","error")})).finally((()=>{this.chk=!0}))}},watch:{startDate(){let t=this.startDate.split("-");this.startDateSplit=t[0]+t[1]+t[2]},endDate(){let t=this.endDate.split("-");this.endDateSplit=t[0]+t[1]+t[2]}}},kt=a(89);const Ct=(0,kt.Z)(wt,[["render",_t]]);var vt=Ct}}]);
//# sourceMappingURL=883.68aab6f2.js.map